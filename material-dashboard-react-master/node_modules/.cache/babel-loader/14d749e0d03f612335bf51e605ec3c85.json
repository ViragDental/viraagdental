{"ast":null,"code":"import _regeneratorRuntime from\"D:/projects/Cricket/akshu close/IPL/material-dashboard-react-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/projects/Cricket/akshu close/IPL/material-dashboard-react-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/projects/Cricket/akshu close/IPL/material-dashboard-react-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from\"react\";// import axios from \"axios\";\n// react plugin for creating charts\n// @material-ui/core\nimport{useEffect,useState}from'react';import{makeStyles}from\"@material-ui/core/styles\";// @material-ui/icons\nimport SportsHandballIcon from'@material-ui/icons/SportsHandball';import TimelineIcon from'@material-ui/icons/Timeline';import GroupIcon from'@material-ui/icons/Group';import Update from\"@material-ui/icons/Update\";import Accessibility from\"@material-ui/icons/Accessibility\";// core components\nimport GridItem from\"components/Grid/GridItem.js\";import GridContainer from\"components/Grid/GridContainer.js\";import Table from\"components/Table/Table.js\";import Card from\"components/Card/Card.js\";import CardHeader from\"components/Card/CardHeader.js\";import CardIcon from\"components/Card/CardIcon.js\";import CardBody from\"components/Card/CardBody.js\";import CardFooter from\"components/Card/CardFooter.js\";import socketIOClient from\"socket.io-client\";import styles from\"assets/jss/material-dashboard-react/views/dashboardStyle.js\";//  const ENDPOINT = \"https://happy-home-ipl-2020.herokuapp.com/\";\nvar ENDPOINT=\"http://localhost:4000\";var useStyles=makeStyles(styles);function leavingDashboard(myConn){console.log(\"Leaving Dashboard wah wah \");myConn.disconnect();}export default function Dashboard(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),rankArray=_useState2[0],setRankArray=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),rank=_useState4[0],setRank=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),score=_useState6[0],setScore=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),mostRuns=_useState8[0],setMostRuns=_useState8[1];var _useState9=useState({}),_useState10=_slicedToArray(_useState9,2),mostWickets=_useState10[0],setMostwickets=_useState10[1];// const [mvp, SetMvp] = useState();\n// const { user } = useContext(UserContext);\nvar date=new Date().toDateString()+\" \"+new Date().toLocaleTimeString();var tableData=function tableData(rankDetails){var arr=rankDetails.map(function(element){var displayName=element.displayName,userName=element.userName,grandScore=element.grandScore,rank=element.rank;//const {rank,displayName,userName,grandScore}=element;\n// return { data: Object.values({ rank, displayName, userName, displayName, grandScore }), collapse: [] }\nreturn{data:Object.values({rank:rank,displayName:displayName,userName:userName,grandScore:grandScore}),collapse:[]};});return arr;};// axios.get(`/stat/sendmydashboard/${localStorage.getItem(\"gid\")}`);\nuseEffect(function(){var sendMessage={page:\"DASH\",gid:localStorage.getItem(\"gid\"),uid:localStorage.getItem(\"uid\")};var makeconnection=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return sockConn.connect();case 2:// console.log(\"just after connect command\");\nsockConn.emit(\"page\",sendMessage);case 3:case\"end\":return _context.stop();}}},_callee);}));return function makeconnection(){return _ref.apply(this,arguments);};}();var sockConn=socketIOClient(ENDPOINT);// console.log(\"in dashboard before make connection\");\nmakeconnection();// console.log(\"in dashboard after make connection\");\nsockConn.on(\"connect\",function(){sockConn.emit(\"page\",sendMessage);sockConn.on(\"rank\",function(rank){console.log(new Date());// console.log(localStorage.getItem(\"uid\"))\nvar allRank=rank.filter(function(x){return x.gid===parseInt(localStorage.getItem(\"gid\"));});var userDetails=allRank.filter(function(x){return x.uid===parseInt(localStorage.getItem(\"uid\"));});if(userDetails.length>0){// if details of current user found (current user is a member of group 1)\n// console.log(\"Data available\");\nsetRank(userDetails[0].rank);setScore(userDetails[0].grandScore);setRankArray(tableData(allRank));}else if(localStorage.getItem(\"admin\")===\"true\"){// current user is not member of the group but is ADMIN. Thus show the rank details\nsetRankArray(tableData(allRank));}});sockConn.on(\"maxRun\",function(maxRun){var allMaxRun=maxRun.filter(function(x){return x.gid===parseInt(localStorage.getItem(\"gid\"));});var runDetails=allMaxRun.filter(function(x){return x.uid===parseInt(localStorage.getItem(\"uid\"));});// console.log(runDetails)\nif(runDetails.length>0){setMostRuns(runDetails[0]);}});sockConn.on(\"maxWicket\",function(maxWicket){var allMaxWicket=maxWicket.filter(function(x){return x.gid===parseInt(localStorage.getItem(\"gid\"));});var wicketDetails=allMaxWicket.filter(function(x){return x.uid===parseInt(localStorage.getItem(\"uid\"));});// console.log(wicketDetails);\nif(wicketDetails.length>0){setMostwickets(wicketDetails[0]);}});});return function(){// componentwillunmount in functional component.\n// Anything in here is fired on component unmount.\nleavingDashboard(sockConn);};},[]);// }, [rankArray]);\nfunction ShowUserBoard(){if(localStorage.getItem(\"ismember\")===\"true\")return/*#__PURE__*/React.createElement(GridContainer,{key:\"db_gc_ub\"},/*#__PURE__*/React.createElement(GridItem,{key:\"db_gi_ub1\",xs:12,sm:6,md:3},/*#__PURE__*/React.createElement(Card,{key:\"db_card_ub1\"},/*#__PURE__*/React.createElement(CardHeader,{key:\"db_chdr_ub1\",color:\"warning\",stats:true,icon:true},/*#__PURE__*/React.createElement(CardIcon,{color:\"warning\"},/*#__PURE__*/React.createElement(GroupIcon,null)),/*#__PURE__*/React.createElement(\"h2\",{className:classes.cardCategory},\"Rank\"),/*#__PURE__*/React.createElement(\"h3\",{className:classes.cardTitle},rank)),/*#__PURE__*/React.createElement(CardFooter,{key:\"db_cftr_ub1\",stats:true},/*#__PURE__*/React.createElement(\"div\",{className:classes.stats},/*#__PURE__*/React.createElement(GroupIcon,null),/*#__PURE__*/React.createElement(\"a\",{href:\"#pablo\",onClick:function onClick(e){return e.preventDefault();}},localStorage.getItem(\"groupName\")))))),/*#__PURE__*/React.createElement(GridItem,{key:\"db_gi_ub2\",xs:12,sm:6,md:3},/*#__PURE__*/React.createElement(Card,{key:\"db_card_ub2\"},/*#__PURE__*/React.createElement(CardHeader,{key:\"db_chdr_ub2\",color:\"success\",stats:true,icon:true},/*#__PURE__*/React.createElement(CardIcon,{color:\"success\"},/*#__PURE__*/React.createElement(TimelineIcon,null)),/*#__PURE__*/React.createElement(\"p\",{className:classes.cardCategory},\"Total Points\"),/*#__PURE__*/React.createElement(\"h3\",{className:classes.cardTitle},score)),/*#__PURE__*/React.createElement(CardFooter,{key:\"db_cftr_ub2\",stats:true},/*#__PURE__*/React.createElement(\"div\",{className:classes.stats},/*#__PURE__*/React.createElement(Update,null),localStorage.getItem(\"tournament\"))))),/*#__PURE__*/React.createElement(GridItem,{key:\"db_gi_ub3\",xs:12,sm:6,md:3},/*#__PURE__*/React.createElement(Card,{key:\"db_card_ub3\"},/*#__PURE__*/React.createElement(CardHeader,{key:\"db_chdr_ub3\",color:\"info\",stats:true,icon:true},/*#__PURE__*/React.createElement(CardIcon,{color:\"info\"},/*#__PURE__*/React.createElement(Accessibility,null)),/*#__PURE__*/React.createElement(\"p\",{className:classes.cardCategory},\"Most Runs\"),/*#__PURE__*/React.createElement(\"h3\",{className:classes.cardTitle},mostRuns?mostRuns.maxRunPlayerName:\"\")),/*#__PURE__*/React.createElement(CardFooter,{key:\"db_cftr_ub3\",stats:true},/*#__PURE__*/React.createElement(\"div\",{className:classes.stats},/*#__PURE__*/React.createElement(Accessibility,null),mostRuns?mostRuns.maxRun:\"\")))),/*#__PURE__*/React.createElement(GridItem,{key:\"db_gi_ub4\",xs:12,sm:6,md:3},/*#__PURE__*/React.createElement(Card,{key:\"db_card_ub4\"},/*#__PURE__*/React.createElement(CardHeader,{key:\"db_chdr_ub4\",color:\"danger\",stats:true,icon:true},/*#__PURE__*/React.createElement(CardIcon,{color:\"danger\"},/*#__PURE__*/React.createElement(SportsHandballIcon,null)),/*#__PURE__*/React.createElement(\"p\",{className:classes.cardCategory},\"Most Wickets\"),/*#__PURE__*/React.createElement(\"h3\",{className:classes.cardTitle},mostWickets?mostWickets.maxWicketPlayerName:\"\")),/*#__PURE__*/React.createElement(CardFooter,{key:\"db_cftr_ub4\",stats:true},/*#__PURE__*/React.createElement(\"div\",{className:classes.stats},/*#__PURE__*/React.createElement(SportsHandballIcon,null),mostWickets?mostWickets.maxWicket:\"\")))));else return/*#__PURE__*/React.createElement(\"div\",null);// no display if not a member\n}function ShowUserRank(){if(localStorage.getItem(\"ismember\")===\"true\"||localStorage.getItem(\"admin\")===\"true\")return/*#__PURE__*/React.createElement(Card,{key:\"db_card\"},/*#__PURE__*/React.createElement(CardHeader,{key:\"db_cheader\",color:\"warning\"},/*#__PURE__*/React.createElement(\"h4\",{className:classes.cardTitleWhite},\"Franchise Score Board\"),/*#__PURE__*/React.createElement(\"p\",{className:classes.cardCategoryWhite},\"Updated as of \".concat(date))),/*#__PURE__*/React.createElement(CardBody,{key:\"db_cbody\"},/*#__PURE__*/React.createElement(Table,{tableHeaderColor:\"warning\",tableHead:[\"Rank\",\"Franchise\",\"Owner\",\"Score\"],tableData:rankArray})));else return/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(CardHeader,{color:\"warning\"},/*#__PURE__*/React.createElement(\"h4\",{className:classes.cardTitleWhite},\"Not a member of this group\")));}var classes=useStyles();return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(ShowUserBoard,null),/*#__PURE__*/React.createElement(ShowUserRank,null));}","map":{"version":3,"sources":["D:/projects/Cricket/akshu close/IPL/material-dashboard-react-master/src/views/Dashboard/Dashboard.js"],"names":["React","useEffect","useState","makeStyles","SportsHandballIcon","TimelineIcon","GroupIcon","Update","Accessibility","GridItem","GridContainer","Table","Card","CardHeader","CardIcon","CardBody","CardFooter","socketIOClient","styles","ENDPOINT","useStyles","leavingDashboard","myConn","console","log","disconnect","Dashboard","rankArray","setRankArray","rank","setRank","score","setScore","mostRuns","setMostRuns","mostWickets","setMostwickets","date","Date","toDateString","toLocaleTimeString","tableData","rankDetails","arr","map","element","displayName","userName","grandScore","data","Object","values","collapse","sendMessage","page","gid","localStorage","getItem","uid","makeconnection","sockConn","connect","emit","on","allRank","filter","x","parseInt","userDetails","length","maxRun","allMaxRun","runDetails","maxWicket","allMaxWicket","wicketDetails","ShowUserBoard","classes","cardCategory","cardTitle","stats","e","preventDefault","maxRunPlayerName","maxWicketPlayerName","ShowUserRank","cardTitleWhite","cardCategoryWhite"],"mappings":"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","sourcesContent":["import React from \"react\";\r\n// import axios from \"axios\";\r\n// react plugin for creating charts\r\n\r\n// @material-ui/core\r\nimport { useEffect, useState } from 'react';\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\n\r\n// @material-ui/icons\r\nimport SportsHandballIcon from '@material-ui/icons/SportsHandball';\r\nimport TimelineIcon from '@material-ui/icons/Timeline';\r\nimport GroupIcon from '@material-ui/icons/Group';\r\n\r\nimport Update from \"@material-ui/icons/Update\";\r\n\r\nimport Accessibility from \"@material-ui/icons/Accessibility\";\r\n\r\n\r\n// core components\r\nimport GridItem from \"components/Grid/GridItem.js\";\r\nimport GridContainer from \"components/Grid/GridContainer.js\";\r\nimport Table from \"components/Table/Table.js\";\r\n\r\n\r\nimport Card from \"components/Card/Card.js\";\r\nimport CardHeader from \"components/Card/CardHeader.js\";\r\nimport CardIcon from \"components/Card/CardIcon.js\";\r\nimport CardBody from \"components/Card/CardBody.js\";\r\nimport CardFooter from \"components/Card/CardFooter.js\";\r\n\r\nimport socketIOClient from \"socket.io-client\";\r\nimport styles from \"assets/jss/material-dashboard-react/views/dashboardStyle.js\";\r\n\r\n//  const ENDPOINT = \"https://happy-home-ipl-2020.herokuapp.com/\";\r\nconst ENDPOINT = \"http://localhost:4000\";\r\n\r\n\r\n\r\n\r\nconst useStyles = makeStyles(styles);\r\n\r\n\r\nfunction leavingDashboard(myConn) {\r\n  console.log(\"Leaving Dashboard wah wah \");\r\n  myConn.disconnect();\r\n}\r\n\r\n\r\n\r\nexport default function Dashboard() {\r\n\r\n  const [rankArray, setRankArray] = useState([]);\r\n  const [rank, setRank] = useState();\r\n  const [score, setScore] = useState(0);\r\n  const [mostRuns, setMostRuns] = useState({});\r\n  const [mostWickets, setMostwickets] = useState({});\r\n  // const [mvp, SetMvp] = useState();\r\n  // const { user } = useContext(UserContext);\r\n  const date = new Date().toDateString() + \" \" + new Date().toLocaleTimeString();\r\n  \r\n\r\n\r\n  const tableData = (rankDetails) => {\r\n    const arr = rankDetails.map(element => {\r\n      const { displayName, userName, grandScore, rank } = element;\r\n      //const {rank,displayName,userName,grandScore}=element;\r\n      // return { data: Object.values({ rank, displayName, userName, displayName, grandScore }), collapse: [] }\r\n      return { data: Object.values({ rank, displayName, userName, grandScore }), collapse: [] }\r\n    });\r\n\r\n    return arr;\r\n  }\r\n\r\n  // axios.get(`/stat/sendmydashboard/${localStorage.getItem(\"gid\")}`);\r\n  useEffect(() => {\r\n    var sendMessage = {page: \"DASH\", gid: localStorage.getItem(\"gid\"), uid: localStorage.getItem(\"uid\") };\r\n\r\n    const makeconnection = async () => {\r\n      await sockConn.connect();\r\n      // console.log(\"just after connect command\");\r\n      sockConn.emit(\"page\", sendMessage);\r\n    }\r\n\r\n    var sockConn = socketIOClient(ENDPOINT);\r\n    // console.log(\"in dashboard before make connection\");\r\n    makeconnection();\r\n    // console.log(\"in dashboard after make connection\");\r\n\r\n    sockConn.on(\"connect\", function() {\r\n      sockConn.emit(\"page\", sendMessage);\r\n      sockConn.on(\"rank\", (rank) => {\r\n        console.log(new Date());\r\n        // console.log(localStorage.getItem(\"uid\"))\r\n        const allRank = rank.filter(x => x.gid === parseInt(localStorage.getItem(\"gid\")));\r\n        const userDetails = allRank.filter(x => x.uid === parseInt(localStorage.getItem(\"uid\")));\r\n\r\n        if (userDetails.length > 0) {\r\n          // if details of current user found (current user is a member of group 1)\r\n          // console.log(\"Data available\");\r\n          setRank(userDetails[0].rank);\r\n          setScore(userDetails[0].grandScore)\r\n          setRankArray(tableData(allRank));\r\n        } else if (localStorage.getItem(\"admin\") === \"true\") {\r\n          // current user is not member of the group but is ADMIN. Thus show the rank details\r\n          setRankArray(tableData(allRank));\r\n        }\r\n\r\n      });\r\n\r\n      sockConn.on(\"maxRun\", (maxRun) => {\r\n\r\n        const allMaxRun = maxRun.filter(x => x.gid === parseInt(localStorage.getItem(\"gid\")));\r\n        const runDetails = allMaxRun.filter(x => x.uid === parseInt(localStorage.getItem(\"uid\")));\r\n        // console.log(runDetails)\r\n        if (runDetails.length > 0) {\r\n          setMostRuns(runDetails[0])\r\n        }\r\n\r\n      });\r\n\r\n      sockConn.on(\"maxWicket\", (maxWicket) => {\r\n        const allMaxWicket = maxWicket.filter(x => x.gid === parseInt(localStorage.getItem(\"gid\")));\r\n        const wicketDetails = allMaxWicket.filter(x => x.uid === parseInt(localStorage.getItem(\"uid\")));\r\n        // console.log(wicketDetails);\r\n        if (wicketDetails.length > 0) {\r\n          setMostwickets(wicketDetails[0]);\r\n        }\r\n\r\n      });\r\n    });\r\n    \r\n    return () => {\r\n      // componentwillunmount in functional component.\r\n      // Anything in here is fired on component unmount.\r\n      leavingDashboard(sockConn);\r\n  }\r\n   \r\n\r\n  }, []);\r\n// }, [rankArray]);\r\n\r\n  function ShowUserBoard() {\r\n    if (localStorage.getItem(\"ismember\") === \"true\")\r\n      return(\r\n      <GridContainer key=\"db_gc_ub\">\r\n        <GridItem key=\"db_gi_ub1\" xs={12} sm={6} md={3}>\r\n          <Card key=\"db_card_ub1\">\r\n            <CardHeader key=\"db_chdr_ub1\" color=\"warning\" stats icon>\r\n              <CardIcon color=\"warning\">\r\n                <GroupIcon />\r\n              </CardIcon>\r\n              <h2 className={classes.cardCategory}>Rank</h2>\r\n              <h3 className={classes.cardTitle}>\r\n                {rank}\r\n              </h3>\r\n            </CardHeader>\r\n            <CardFooter key=\"db_cftr_ub1\" stats>\r\n              <div className={classes.stats}>\r\n                <GroupIcon />\r\n                <a href=\"#pablo\" onClick={e => e.preventDefault()}>\r\n                  {localStorage.getItem(\"groupName\")}\r\n                </a>\r\n              </div>\r\n            </CardFooter>\r\n          </Card>\r\n        </GridItem>\r\n        <GridItem key=\"db_gi_ub2\" xs={12} sm={6} md={3}>\r\n          <Card key=\"db_card_ub2\">\r\n            <CardHeader key=\"db_chdr_ub2\" color=\"success\" stats icon>\r\n              <CardIcon color=\"success\">\r\n                <TimelineIcon />\r\n              </CardIcon>\r\n              <p className={classes.cardCategory}>Total Points</p>\r\n              <h3 className={classes.cardTitle}>{score}</h3>\r\n            </CardHeader>\r\n            <CardFooter key=\"db_cftr_ub2\" stats>\r\n              <div className={classes.stats}>\r\n                <Update />\r\n                {localStorage.getItem(\"tournament\")}\r\n              </div>\r\n            </CardFooter>\r\n          </Card>\r\n        </GridItem>\r\n        <GridItem key=\"db_gi_ub3\" xs={12} sm={6} md={3}>\r\n          <Card key=\"db_card_ub3\">\r\n            <CardHeader key=\"db_chdr_ub3\" color=\"info\" stats icon>\r\n              <CardIcon color=\"info\">\r\n                <Accessibility />\r\n              </CardIcon>\r\n              <p className={classes.cardCategory}>Most Runs</p>\r\n              <h3 className={classes.cardTitle}>{mostRuns ? mostRuns.maxRunPlayerName : \"\"}</h3>\r\n            </CardHeader>\r\n            <CardFooter key=\"db_cftr_ub3\" stats>\r\n              <div className={classes.stats}>\r\n                <Accessibility />\r\n                {mostRuns ? mostRuns.maxRun : \"\"}\r\n              </div>\r\n            </CardFooter>\r\n          </Card>\r\n        </GridItem>\r\n        <GridItem key=\"db_gi_ub4\" xs={12} sm={6} md={3}>\r\n          <Card key=\"db_card_ub4\">\r\n            <CardHeader key=\"db_chdr_ub4\" color=\"danger\" stats icon>\r\n              <CardIcon color=\"danger\">\r\n                <SportsHandballIcon />\r\n              </CardIcon>\r\n              <p className={classes.cardCategory}>Most Wickets</p>\r\n              <h3 className={classes.cardTitle}>{mostWickets ? mostWickets.maxWicketPlayerName : \"\"}</h3>\r\n            </CardHeader>\r\n            <CardFooter key=\"db_cftr_ub4\" stats>\r\n              <div className={classes.stats}>\r\n                <SportsHandballIcon />\r\n                {mostWickets ? mostWickets.maxWicket : \"\"}\r\n              </div>\r\n            </CardFooter>\r\n          </Card>\r\n        </GridItem>\r\n      </GridContainer>\r\n      )\r\n    else\r\n        return(<div></div>);        // no display if not a member\r\n  } \r\n\r\n  function ShowUserRank() {\r\n    if ((localStorage.getItem(\"ismember\") === \"true\") || (localStorage.getItem(\"admin\") === \"true\"))\r\n    return(\r\n        <Card key=\"db_card\">\r\n          <CardHeader key=\"db_cheader\" color=\"warning\">\r\n            <h4 className={classes.cardTitleWhite}>Franchise Score Board</h4>\r\n            <p className={classes.cardCategoryWhite}>\r\n              {`Updated as of ${date}`}\r\n            </p>\r\n          </CardHeader>\r\n          <CardBody key=\"db_cbody\">\r\n            <Table\r\n              tableHeaderColor=\"warning\"\r\n              tableHead={[\"Rank\", \"Franchise\", \"Owner\", \"Score\"]}\r\n              tableData={rankArray}\r\n            />\r\n          </CardBody>\r\n        </Card>\r\n    )\r\n    else \r\n    return (\r\n        <Card>\r\n          <CardHeader color=\"warning\">\r\n            <h4 className={classes.cardTitleWhite}>Not a member of this group</h4>\r\n          </CardHeader>\r\n        </Card>\r\n    )\r\n  }\r\n\r\n  const classes = useStyles();\r\n\r\n\r\n  return (\r\n    <div>\r\n      <ShowUserBoard />\r\n      <ShowUserRank />\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}